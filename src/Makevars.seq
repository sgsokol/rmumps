DMUMPS=lib/MUMPS_5.1.2
RANLIB?=ranlib

INC_OS := $(shell "$(R_HOME)/bin/Rscript" ../R/inc_os.R)

PKG_CXXFLAGS=-I$(DMUMPS)/include
PKG_LIBS= -L./lib -ldmumps -lmumps_common -lmpiseq -lpord -lmetis -lesmumps -lscotch -lscotcherr -pthread $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

$(SHLIB): lib/libdmumps.a

lib/libdmumps.a:
	$(MAKE) -C lib \
	  CC="$(CC)" FC="$(F77)" PKG_CFLAGS="$(CFLAGS) $(CPICFLAGS)"  PKG_FCFLAGS="$(FFLAGS) $(FPICFLAGS)" AR="$(AR)" RANLIB="$(RANLIB)" INC_OS="$(INC_OS)"
